<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.recipe.a.dao.MembersDao">

	<select id="countMembers" resultType="Integer">
		SELECT COUNT(*) FROM MEMBERS
	</select>

	<select id="getSalt" parameterType="String" resultType="com.recipe.a.dto.MembersDto">
		SELECT SALT FROM MEMBERS
		WHERE MEMBERID = #{memberId}
	</select>
	
	<select id="login" parameterType="String" resultType="com.recipe.a.dto.MembersDto">
		SELECT MEMBERID, MEMBERNICKNAME, MEMBEREMAIL, MEMBERPHONE, MEMBERCOIN, MEMBERMAINADDR, MEMBERDETAILADDR,
			   MEMBERZIPCODE, MEMBERGENDER, MEMBERNAME, MEMBERGRADE
		FROM MEMBERS
		WHERE MEMBERPWD = #{memberPwd}
	</select>
	
	<!-- 아이디 중복체크 -->
	<select id="idCheck" parameterType="com.recipe.a.dto.MembersDto" resultType="Integer">
		SELECT COUNT(*)
		FROM MEMBERS
		WHERE MEMBERID = #{memberId} 
	</select>
	
	<!-- 회원가입 -->
	<insert id="regist" parameterType="com.recipe.a.dto.MembersDto">
		INSERT INTO MEMBERS(
			memberId, memberPwd, memberNickname, memberEmail,
			memberPhone, memberCoin, memberMainAddr, memberDetailAddr,
			memberZipcode, memberGender, memberName, memberGrade, salt)
		VALUES(#{memberId}, #{memberPwd}, #{memberNickname}, #{memberEmail},
			   #{memberPhone}, #{memberCoin}, #{memberMainAddr}, #{memberDetailAddr},
			   #{memberZipcode}, #{memberGender}, #{memberName}, #{memberGrade}, #{salt})
	</insert>
	
	<select id="test1" resultType="com.recipe.a.dto.RecipeDto">
		SELECT *
		FROM RECIPE
	</select>

	<!-- 이메일 업데이트  -->
	<update id="updateEmail" parameterType="String">
		UPDATE MEMBERS
		SET MEMBEREMAIL = #{memberEmail}
		WHERE MEMBERID = #{memberId}
	</update>
	<!-- 닉네임 업데이트 -->
	<update id="updateNickname" parameterType="String">
		UPDATE MEMBERS
		SET MEMBERNICKNAME = #{memberNickname}
		WHERE MEMBERID = #{memberId}
	</update>
	<!-- 전화번호 업데이트 -->
	<update id="updatePhone" parameterType="String">
		UPDATE MEMBERS
		SET MEMBERNICKNAME = #{memberPhone}
		WHERE MEMBERID = #{memberId}
	</update>
	<!-- 주소 업데이트 -->
	<update id="updateAddr" parameterType="com.recipe.a.dto.MembersDto">
		UPDATE MEMBERS
		SET MEMBERMAINADDR = #{memberMainAddr}, MEMBERDETAILADDR = #{memberDetailAddr}, MEMBERZIPCODE = #{memberZipcode}
		WHERE MEMBERID = #{memberId}
		
	</update>
</mapper>